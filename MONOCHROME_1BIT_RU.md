# 1-–±–∏—Ç–Ω–æ–µ –º–æ–Ω–æ—Ö—Ä–æ–º–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ª–∏–Ω–∏–π –¥–ª—è ESP32-CAM

## üéØ –û–±–∑–æ—Ä

–í —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø–æ–¥—Ö–æ–¥ –∫ 1-–±–∏—Ç–Ω–æ–π (–±–∏–Ω–∞—Ä–Ω–æ–π) –º–æ–Ω–æ—Ö—Ä–æ–º–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —Å–≤–µ—Ä—Ö–±—ã—Å—Ç—Ä–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ª–∏–Ω–∏–π –Ω–∞ ESP32-CAM, –≤–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ä–µ—Ç—Ä–æ-–∫–∞–º–µ—Ä–∞–º–∏ —Å 1-–±–∏—Ç–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º.

## üöÄ –ü–æ—á–µ–º—É 1-–±–∏—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞?

### –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è –≥—Ä–∞–¥–∞—Ü–∏—è —Å–µ—Ä–æ–≥–æ (8 –±–∏—Ç) –ø—Ä–æ—Ç–∏–≤ 1-–±–∏—Ç–Ω–æ–π –±–∏–Ω–∞—Ä–Ω–æ–π

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –ì—Ä–∞–¥–∞—Ü–∏–∏ —Å–µ—Ä–æ–≥–æ (8 –±–∏—Ç) | 1-–±–∏—Ç–Ω–∞—è –±–∏–Ω–∞—Ä–Ω–∞—è |
|----------------|------------------------|-------------------|
| **–ü–∞–º—è—Ç—å –Ω–∞ –ø–∏–∫—Å–µ–ª—å** | 1 –±–∞–π—Ç | 1 –±–∏—Ç (–≤ 8 —Ä–∞–∑ –º–µ–Ω—å—à–µ) |
| **–ö–∞–¥—Ä QQVGA** | 19 200 –±–∞–π—Ç | 2 400 –±–∞–π—Ç |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞** | –°–ª–æ–∂–Ω–∞—è | –ü—Ä–æ—Å—Ç—ã–µ –±—É–ª–µ–≤—ã –æ–ø–µ—Ä–∞—Ü–∏–∏ |
| **–°–∫–æ—Ä–æ—Å—Ç—å** | –°—Ä–µ–¥–Ω—è—è | –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è |
| **–õ—É—á—à–µ –¥–ª—è** | –û–±—â–µ–µ –∑—Ä–µ–Ω–∏–µ | –ö–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–µ –ª–∏–Ω–∏–∏ |

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ 1-–±–∏—Ç–∞

1. **–í 8 —Ä–∞–∑ –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏**: –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π RAM ESP32
2. **–ë–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –ë—É–ª–µ–≤—ã –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫—Ä–∞–π–Ω–µ –±—ã—Å—Ç—Ä–æ
3. **–ë–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**: –ë–∏–Ω–∞—Ä–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—Å—Ç—Ä–∞–Ω—è—é—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≥—Ä–∞–¥–∞—Ü–∏–π —Å–µ—Ä–æ–≥–æ
4. **–õ—É—á—à–µ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ª–∏–Ω–∏–π**: –ß–µ—Ä–Ω—ã–µ –ª–∏–Ω–∏–∏ –Ω–∞ –±–µ–ª–æ–º —Ñ–æ–Ω–µ –∏–¥–µ–∞–ª—å–Ω—ã –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
5. **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 1-–±–∏—Ç

‚úÖ **–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è:**
- –ß–µ—Ä–Ω–∞—è –ª–∏–Ω–∏—è –Ω–∞ –±–µ–ª–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
- –ë–µ–ª–∞—è –ª–∏–Ω–∏—è –Ω–∞ —á–µ—Ä–Ω–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
- –í—ã—Å–æ–∫–æ–∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–µ —Å—Ä–µ–¥—ã
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏
- –°–∏—Å—Ç–µ–º—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é

‚ùå **–ù–µ –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è:**
- –ù–∏–∑–∫–æ–∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–µ —Å—Ü–µ–Ω—ã
- –¶–≤–µ—Ç–Ω—ã–µ –ª–∏–Ω–∏–∏ –Ω–∞ —Ü–≤–µ—Ç–Ω–æ–º —Ñ–æ–Ω–µ
- –°–ª–æ–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –æ—Å–≤–µ—â–µ–Ω–∏—è
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ: AI-Thinker ESP32-CAM
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: QQVGA (160√ó120)
- –¢—Ä–∞—Å—Å–∞: –ß–µ—Ä–Ω–∞—è –ª–µ–Ω—Ç–∞ 2 —Å–º –Ω–∞ –±–µ–ª–æ–π –±—É–º–∞–≥–µ
- –û—Å–≤–µ—â–µ–Ω–∏–µ: –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ LED-–æ—Å–≤–µ—â–µ–Ω–∏–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ú–µ—Ç–æ–¥ | FPS | –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ | –°–∫–æ—Ä–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è |
|-------|-----|----------------|---------------------|---------------------|
| **–ì—Ä–∞–¥–∞—Ü–∏–∏ —Å–µ—Ä–æ–≥–æ** | 12-15 | 60-80 –º—Å | 19.2 –ö–ë | 95% |
| **1-–±–∏—Ç–Ω–∞—è –±–∏–Ω–∞—Ä–Ω–∞—è** | 20-30 | 30-40 –º—Å | 2.4 –ö–ë | 98% |
| **JPEG** | 5-8 | 120-150 –º—Å | –ü–µ—Ä–µ–º–µ–Ω–Ω–æ | 90% |

**–í—ã–≤–æ–¥**: 1-–±–∏—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ **–≤ 2 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ** –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≤ 8 —Ä–∞–∑ –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏**, —á–µ–º –≥—Ä–∞–¥–∞—Ü–∏–∏ —Å–µ—Ä–æ–≥–æ!

## üîß –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ê–ª–≥–æ—Ä–∏—Ç–º –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

```cpp
// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–∏–∫—Å–µ–ª—è –≤ –≥—Ä–∞–¥–∞—Ü–∏—è—Ö —Å–µ—Ä–æ–≥–æ –≤ –±–∏–Ω–∞—Ä–Ω—ã–π
–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏:
    –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ_–ø–∏–∫—Å–µ–ª—è >= –ø–æ—Ä–æ–≥:
        –≤—ã—Ö–æ–¥–Ω–æ–π_–ø–∏–∫—Å–µ–ª—å = 1  // –ë–µ–ª—ã–π
    –∏–Ω–∞—á–µ:
        –≤—ã—Ö–æ–¥–Ω–æ–π_–ø–∏–∫—Å–µ–ª—å = 0  // –ß–µ—Ä–Ω—ã–π
```

### –í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞

–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ (0-255) –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è "—á–µ—Ä–Ω—ã–º" –∏ "–±–µ–ª—ã–º":

- **–ù–∏–∑–∫–∏–π –ø–æ—Ä–æ–≥ (80-100)**: –ë–æ–ª—å—à–µ –ø–∏–∫—Å–µ–ª–µ–π —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –±–µ–ª—ã–º–∏
  - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–≥–¥–∞: –õ–∏–Ω–∏—è —Å–ª–∞–±–∞—è –∏–ª–∏ –æ—Å–≤–µ—â–µ–Ω–∏–µ —Ç—É—Å–∫–ª–æ–µ
  - –†–∏—Å–∫: –ú–æ–∂–Ω–æ –ø–æ—Ç–µ—Ä—è—Ç—å –¥–µ—Ç–∞–ª–∏ –ª–∏–Ω–∏–∏

- **–°—Ä–µ–¥–Ω–∏–π –ø–æ—Ä–æ–≥ (120-140)**: –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
  - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–≥–¥–∞: –•–æ—Ä–æ—à–µ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ, —á–µ—Ç–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç
  - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –Ω–∞—á–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞**

- **–í—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥ (160-180)**: –ë–æ–ª—å—à–µ –ø–∏–∫—Å–µ–ª–µ–π —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —á–µ—Ä–Ω—ã–º–∏
  - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–≥–¥–∞: –û—á–µ–Ω—å —è—Ä–∫–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ, –Ω—É–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ñ–æ–Ω
  - –†–∏—Å–∫: –ú–æ–∂–Ω–æ –ø–æ—Ç–µ—Ä—è—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª–∏–Ω–∏–∏

### –ü—Ä–æ—Ü–µ—Å—Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

1. **–ó–∞—Ö–≤–∞—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∫–∞–¥—Ä** –≤ –≤–∞—à–µ–π —Å—Ä–µ–¥–µ
2. **–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É** –∑–Ω–∞—á–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π
3. **–ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑—Ä—ã–≤** –º–µ–∂–¥—É –ø–∏–∫–∞–º–∏ –ª–∏–Ω–∏–∏ (—Ç–µ–º–Ω—ã–µ) –∏ —Ñ–æ–Ω–∞ (—Å–≤–µ—Ç–ª—ã–µ)
4. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–æ—Ä–æ–≥** –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —Ä–∞–∑—Ä—ã–≤–∞

–ü—Ä–∏–º–µ—Ä:
```
–¢–µ–º–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏ (–ª–∏–Ω–∏—è):     50-80
–°–≤–µ—Ç–ª—ã–µ –ø–∏–∫—Å–µ–ª–∏ (—Ñ–æ–Ω):      170-220
–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥: 125 (—Å–µ—Ä–µ–¥–∏–Ω–∞ —Ä–∞–∑—Ä—ã–≤–∞ 80-170)
```

## üíª –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ

```cpp
#include "MonochromeLineDetection.h"

// –°–æ–∑–¥–∞—Ç—å –¥–µ—Ç–µ–∫—Ç–æ—Ä —Å –ø–æ—Ä–æ–≥–æ–º 128
MonochromeLineDetection detector(128);

void loop() {
    camera_fb_t* fb = esp_camera_fb_get();
    
    // –û–±–Ω–∞—Ä—É–∂–∏—Ç—å –ª–∏–Ω–∏—é
    MonoLineResult result = detector.detectLine(fb);
    
    if (result.detected) {
        Serial.printf("–õ–∏–Ω–∏—è –Ω–∞ %d%%, –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: %+d\n", 
                     result.position, result.deviation);
    }
    
    esp_camera_fb_return(fb);
}
```

### –° —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –º–æ—Ç–æ—Ä–∞–º–∏

```cpp
if (result.detected) {
    // –ü–ò–î-—Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
    float error = result.deviation;  // –æ—Ç -50 –¥–æ +50
    float control = Kp * error;
    
    // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–µ–π –º–æ—Ç–æ—Ä–æ–≤
    leftSpeed = baseSpeed + control;
    rightSpeed = baseSpeed - control;
}
```

## üé® –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è 1-–±–∏—Ç–Ω–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è

| –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ | –ü–∏–∫—Å–µ–ª–∏ | –†–∞–∑–º–µ—Ä –±–∏–Ω–∞—Ä–Ω–æ–≥–æ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|-----------|---------|------------------|------------|
| **QQVGA** | 160√ó120 | 2.4 –ö–ë | ‚≠ê **–õ—É—á—à–µ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏** |
| **QCIF** | 176√ó144 | 3.2 –ö–ë | –•–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å |
| **QVGA** | 320√ó240 | 9.6 –ö–ë | –ë–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π, –º–µ–¥–ª–µ–Ω–Ω–µ–µ |
| **CIF** | 400√ó296 | 14.8 –ö–ë | –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–∞—á–Ω–∏—Ç–µ —Å QQVGA (160√ó120) –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–º–µ—Ä—ã –¥–ª—è 1-–±–∏—Ç–∞

–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ESP32-CAM –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:

```cpp
sensor_t * s = esp_camera_sensor_get();

// –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç –¥–ª—è —á–µ—Ç–∫–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
s->set_contrast(s, 2);          // –î–∏–∞–ø–∞–∑–æ–Ω: –æ—Ç -2 –¥–æ +2

// –£–¥–∞–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
s->set_saturation(s, -2);       // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç—å

// –ß–µ—Ç–∫–∏–µ –∫—Ä–∞—è –¥–ª—è —è—Å–Ω—ã—Ö –ª–∏–Ω–∏–π
s->set_sharpness(s, 2);         // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∑–∫–æ—Å—Ç—å

// –ë–µ–∑ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏—è (–¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏)
s->set_denoise(s, 0);

// –ö–æ—Ä—Ä–µ–∫—Ü–∏–∏, –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫ –±–∏–Ω–∞—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ
s->set_bpc(s, 1);               // –ö–æ—Ä—Ä–µ–∫—Ü–∏—è —á–µ—Ä–Ω—ã—Ö –ø–∏–∫—Å–µ–ª–µ–π
s->set_wpc(s, 1);               // –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –±–µ–ª—ã—Ö –ø–∏–∫—Å–µ–ª–µ–π
s->set_raw_gma(s, 1);           // –ì–∞–º–º–∞-–∫–æ—Ä—Ä–µ–∫—Ü–∏—è
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞

### –®–∞–≥ 1: –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –ø–æ—Ä–æ–≥–∞

```cpp
// –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π
detector.setDebug(true);

// –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –ø–æ—Ä–æ–≥–∏
for (int t = 80; t <= 180; t += 20) {
    detector.setThreshold(t);
    MonoLineResult result = detector.detectLine(fb);
    Serial.printf("–ü–æ—Ä–æ–≥ %d: %s\n", 
                 t, result.detected ? "–û–ë–ù–ê–†–£–ñ–ï–ù–û" : "–ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û");
}
```

### –®–∞–≥ 2: –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ —à–∏—Ä–∏–Ω—ã

–ò–∑–º–µ—Ä—å—Ç–µ —à–∏—Ä–∏–Ω—É –≤–∞—à–µ–π –ª–∏–Ω–∏–∏ –≤ –ø–∏–∫—Å–µ–ª—è—Ö:

```
–®–∏—Ä–∏–Ω–∞ –ª–∏–Ω–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏: 2 —Å–º
–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∫–∞–º–µ—Ä—ã: 10 —Å–º
–®–∏—Ä–∏–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 160 –ø–∏–∫—Å–µ–ª–µ–π
–ü–æ–ª–µ –∑—Ä–µ–Ω–∏—è: ~40 —Å–º

–®–∏—Ä–∏–Ω–∞ –ª–∏–Ω–∏–∏ –≤ –ø–∏–∫—Å–µ–ª—è—Ö: (2 / 40) * 160 = 8 –ø–∏–∫—Å–µ–ª–µ–π
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∏–Ω–∏–º—É–º: 5-6 –ø–∏–∫—Å–µ–ª–µ–π (—Å –∑–∞–ø–∞—Å–æ–º)
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```cpp
unsigned long start = millis();
for (int i = 0; i < 100; i++) {
    MonoLineResult result = detector.detectLine(fb);
}
unsigned long elapsed = millis() - start;
float avgTime = elapsed / 100.0;
float fps = 1000.0 / avgTime;

Serial.printf("–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: %.1f –º—Å\n", avgTime);
Serial.printf("–û–∂–∏–¥–∞–µ–º—ã–π FPS: %.1f\n", fps);
```

**–¶–µ–ª—å**: < 40 –º—Å –Ω–∞ –∫–∞–¥—Ä (>25 FPS)

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –õ–∏–Ω–∏—è –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ - –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–º –∏–ª–∏ –Ω–∏–∑–∫–∏–º
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —à–∏—Ä–∏–Ω—ã –ª–∏–Ω–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ - –Ω—É–∂–µ–Ω —Ö–æ—Ä–æ—à–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–º–µ—Ä–∞ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –ª–∏–Ω–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è

**–†–µ—à–µ–Ω–∏—è:**
1. –£–≤–µ–ª–∏—á—å—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É –ª–∏–Ω–∏–∏
2. –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ—Ä–æ–≥–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
4. –£–ª—É—á—à–∏—Ç–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ç–µ–Ω–µ–π

### –ü—Ä–æ–±–ª–µ–º–∞: –î–µ—Ä–≥–∞—é—â–µ–µ—Å—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏—è:**
1. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é (—Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ)
2. –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –∏ —É—Å—Ä–µ–¥–Ω—è–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
3. –î–æ–±–∞–≤—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
4. –£–º–µ–Ω—å—à–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Kp –ü–ò–î-—Ä–µ–≥—É–ª—è—Ç–æ—Ä–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–†–µ—à–µ–Ω–∏—è:**
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ QQVGA (160√ó120)
2. –£–º–µ–Ω—å—à–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
3. –û—Ç–∫–ª—é—á–∏—Ç–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –≤—ã–≤–æ–¥
4. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–ø—É—Å–∫ –∫–∞–¥—Ä–æ–≤

## üìà –°–æ–≤–µ—Ç—ã –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏

```cpp
// –ù–µ –≤—ã–¥–µ–ª—è–π—Ç–µ –±—É—Ñ–µ—Ä –¥–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ –æ–Ω –Ω–µ –Ω—É–∂–µ–Ω
// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –≥—Ä–∞–¥–∞—Ü–∏–∏ —Å–µ—Ä–æ–≥–æ –Ω–∞–ø—Ä—è–º—É—é —Å –ø–æ—Ä–æ–≥–æ–º

int scanRow(uint8_t* pixels, int width, int row) {
    for (int x = 0; x < width; x++) {
        if (pixels[row * width + x] < threshold) {
            // –ù–∞–π–¥–µ–Ω —Ç–µ–º–Ω—ã–π –ø–∏–∫—Å–µ–ª—å
        }
    }
}
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏

```cpp
// –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ –∫–∞–∂–¥—ã–π N-–π –ø–∏–∫—Å–µ–ª—å –¥–ª—è –µ—â–µ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
for (int x = 0; x < width; x += 2) {  // –ü—Ä–æ–ø—É—Å–∫–∞–π—Ç–µ –∫–∞–∂–¥—ã–π –≤—Ç–æ—Ä–æ–π –ø–∏–∫—Å–µ–ª—å
    if (pixels[idx] < threshold) {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞
    }
}

// –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ –º–µ–Ω—å—à–µ —Å—Ç—Ä–æ–∫
#define SCAN_ROWS 4  // –í–º–µ—Å—Ç–æ 8
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏

```cpp
// –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
int votes[100] = {0};  // –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –ø–æ–∑–∏—Ü–∏–π
for (int row in scanRows) {
    int pos = detectInRow(row);
    if (pos >= 0) votes[pos]++;
}
// –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–∑–∏—Ü–∏—é —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≥–æ–ª–æ—Å–æ–≤
```

## üî¨ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–∫–æ–≤

```cpp
bool isIntersection(MonoLineResult result) {
    // –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ, –∫–æ–≥–¥–∞ –ª–∏–Ω–∏—è –≤–Ω–µ–∑–∞–ø–Ω–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞–º–Ω–æ–≥–æ —à–∏—Ä–µ
    return (result.width > normalWidth * 1.8);
}
```

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–æ–≤ –ª–∏–Ω–∏–∏

```cpp
// –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–µ–ª–æ–≤ –≤ –ª–∏–Ω–∏–∏ (–ø—É–Ω–∫—Ç–∏—Ä–Ω—ã–µ –ª–∏–Ω–∏–∏)
if (!result.detected && wasDetected) {
    gapCounter++;
    if (gapCounter > MAX_GAP_FRAMES) {
        // –ò—Å—Ç–∏–Ω–Ω–∞—è –ø–æ—Ç–µ—Ä—è –ª–∏–Ω–∏–∏
    }
} else {
    gapCounter = 0;
}
```

## üìö –°—Å—ã–ª–∫–∏

### –í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ —Ä–µ—Ç—Ä–æ-–∫–∞–º–µ—Ä–æ–π —Å 1 –±–∏—Ç–æ–º

–£–ø–æ–º—è–Ω—É—Ç—ã–π –ø–æ—Å—Ç –Ω–∞ Reddit: [ESP32 Retro 1-bit Camera](https://www.reddit.com/r/esp32/comments/1hnoadv/esp32_retro_1bit_camera/)

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, —á—Ç–æ 1-–±–∏—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–æ–∂–µ—Ç –±—ã—Ç—å:
- –≠—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π (—Ä–µ—Ç—Ä–æ-–≤–∏–¥)
- –û—á–µ–Ω—å –ø—Ä–∞–∫—Ç–∏—á–Ω–æ–π (—Å–∫–æ—Ä–æ—Å—Ç—å + –ø–∞–º—è—Ç—å)
- –ò–¥–µ–∞–ª—å–Ω–æ–π –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ª–∏–Ω–∏–π

## üéØ –ö—Ä–∞—Ç–∫–æ–µ –∏–∑–ª–æ–∂–µ–Ω–∏–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫

1. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ QQVGA** (160√ó120) –¥–ª—è –ª—É—á—à–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
2. ‚úÖ **–ù–∞—á–Ω–∏—Ç–µ —Å –ø–æ—Ä–æ–≥–∞ 128** –∏ –æ—Ç–∫–∞–ª–∏–±—Ä—É–π—Ç–µ
3. ‚úÖ **–ú–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ç—Ä–∞—Å—Ç –∫–∞–º–µ—Ä—ã** –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
4. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
5. ‚úÖ **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É –ª–∏–Ω–∏–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏
6. ‚úÖ **–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏** –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
7. ‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö** –æ—Å–≤–µ—â–µ–Ω–∏—è
8. ‚úÖ **–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ FPS** –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

1-–±–∏—Ç–Ω–∞—è –º–æ–Ω–æ—Ö—Ä–æ–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è —Ä–æ–±–æ—Ç–æ–≤ ESP32-CAM, —Å–ª–µ–¥—É—é—â–∏—Ö –ø–æ –ª–∏–Ω–∏–∏:

- **–í 2 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ**, —á–µ–º –≥—Ä–∞–¥–∞—Ü–∏–∏ —Å–µ—Ä–æ–≥–æ
- **–í 8 —Ä–∞–∑ –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏**
- **–ü—Ä–æ—Å—Ç–∞—è –∏ –Ω–∞–¥–µ–∂–Ω–∞—è** –¥–ª—è –≤—ã—Å–æ–∫–æ–∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **–õ–µ–≥–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è** —Å –æ–¥–Ω–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –ø–æ—Ä–æ–≥–∞

–í —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º (QQVGA) —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–ª–µ–¥–æ–≤–∞—Ç—å –ø–æ –ª–∏–Ω–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏!
